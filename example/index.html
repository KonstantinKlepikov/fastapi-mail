
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="fastapi-mail">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>Example - FastApi-MAIL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sending-email-with-fastapi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="FastApi-MAIL" class="md-header-nav__button md-logo" aria-label="FastApi-MAIL">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            FastApi-MAIL
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Example
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/sabuhish/fastapi-mail" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    fastapi-mail
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FastApi-MAIL" class="md-nav__button md-logo" aria-label="FastApi-MAIL">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    FastApi-MAIL
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/sabuhish/fastapi-mail" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    fastapi-mail
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        FastApi MAIL
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        ðŸ”¨ Installation
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        ðŸ•¹ Getting Started
      </a>
    </li>
  

    
      
      
      


  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Example
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Example
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sending-email-with-fastapi" class="md-nav__link">
    Sending email with FastApi
  </a>
  
    <nav class="md-nav" aria-label="Sending email with FastApi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-of-usefull-examples" class="md-nav__link">
    List of Usefull Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#email-as-background-task" class="md-nav__link">
    Email as background task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-files" class="md-nav__link">
    Sending files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-jinja2-html-templates" class="md-nav__link">
    Using Jinja2 HTML Templates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guide-for-email-utils" class="md-nav__link">
    Guide for email utils
  </a>
  
    <nav class="md-nav" aria-label="Guide for email utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-dispasoble-email-address" class="md-nav__link">
    Check dispasoble email address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-dispasoble-email-address" class="md-nav__link">
    Add dispasoble email address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-domain-to-blocked-list" class="md-nav__link">
    Add domain to blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-domain-blocked-or-not" class="md-nav__link">
    Check domain blocked or not
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-email-address-to-blocked-list" class="md-nav__link">
    Add email address to blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-email-blocked-or-not" class="md-nav__link">
    Check email blocked or not
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-mx-record" class="md-nav__link">
    Check MX record
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-email-address-from-blocked-list" class="md-nav__link">
    Remove email address from blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-domain-from-blocked-list" class="md-nav__link">
    Remove domain from blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-domain-from-temporary-list" class="md-nav__link">
    Remove domain from temporary list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-email-utils-with-redis" class="md-nav__link">
    Use email utils with Redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whoisxmlapi" class="md-nav__link">
    WhoIsXmlApi
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unittests-using-fastapimail" class="md-nav__link">
    Unittests using FastapiMail
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        Contirbution
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sending-email-with-fastapi" class="md-nav__link">
    Sending email with FastApi
  </a>
  
    <nav class="md-nav" aria-label="Sending email with FastApi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-of-usefull-examples" class="md-nav__link">
    List of Usefull Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#email-as-background-task" class="md-nav__link">
    Email as background task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-files" class="md-nav__link">
    Sending files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-jinja2-html-templates" class="md-nav__link">
    Using Jinja2 HTML Templates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guide-for-email-utils" class="md-nav__link">
    Guide for email utils
  </a>
  
    <nav class="md-nav" aria-label="Guide for email utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-dispasoble-email-address" class="md-nav__link">
    Check dispasoble email address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-dispasoble-email-address" class="md-nav__link">
    Add dispasoble email address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-domain-to-blocked-list" class="md-nav__link">
    Add domain to blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-domain-blocked-or-not" class="md-nav__link">
    Check domain blocked or not
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-email-address-to-blocked-list" class="md-nav__link">
    Add email address to blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-email-blocked-or-not" class="md-nav__link">
    Check email blocked or not
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-mx-record" class="md-nav__link">
    Check MX record
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-email-address-from-blocked-list" class="md-nav__link">
    Remove email address from blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-domain-from-blocked-list" class="md-nav__link">
    Remove domain from blocked list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-domain-from-temporary-list" class="md-nav__link">
    Remove domain from temporary list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-email-utils-with-redis" class="md-nav__link">
    Use email utils with Redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whoisxmlapi" class="md-nav__link">
    WhoIsXmlApi
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unittests-using-fastapimail" class="md-nav__link">
    Unittests using FastapiMail
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Example</h1>
                
                <h2 id="sending-email-with-fastapi">Sending email with FastApi<a class="headerlink" href="#sending-email-with-fastapi" title="Permanent link">&para;</a></h2>
<h3 id="list-of-usefull-examples">List of Usefull Examples<a class="headerlink" href="#list-of-usefull-examples" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from fastapi import (
    FastAPI, 
    BackgroundTasks, 
    UploadFile, File, 
    Form, 
    Query,
    Body,
    Depends
)
from starlette.responses import JSONResponse
from starlette.requests import Request
from fastapi_mail import FastMail, MessageSchema,ConnectionConfig
from pydantic import EmailStr, BaseModel
from typing import List
from fastapi_mail.email_utils import DefaultChecker

class EmailSchema(BaseModel):
    email: List[EmailStr]


conf = ConnectionConfig(
    MAIL_USERNAME = &quot;YourUsername&quot;,
    MAIL_PASSWORD = &quot;strong_password&quot;,
    MAIL_FROM = &quot;your@email.com&quot;,
    MAIL_PORT = 587,
    MAIL_SERVER = &quot;your mail server&quot;,
    MAIL_FROM_NAME=&quot;Desired Name&quot;
    MAIL_TLS = True,
    MAIL_SSL = False,
    USER_CREDENTIALS = True
)

app = FastAPI()


html = &quot;&quot;&quot;
&lt;p&gt;Hi this test mail, thanks for using Fastapi-mail&lt;/p&gt; 
&quot;&quot;&quot;


@app.post(&quot;/email&quot;)
async def simple_send(
    email: EmailSchema
    ) -&gt; JSONResponse:

    message = MessageSchema(
        subject=&quot;Fastapi-Mail module&quot;,
        recipients=email.dict().get(&quot;email&quot;),  # List of recipients, as many as you can pass 
        body=html,
        subtype=&quot;html&quot;
        )

    fm = FastMail(conf)
    await fm.send_message(message)
    return JSONResponse(status_code=200, content={&quot;message&quot;: &quot;email has been sent&quot;})



</code></pre>
<h3 id="email-as-background-task">Email as background task<a class="headerlink" href="#email-as-background-task" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">
@app.post(&quot;/emailbackground&quot;)
async def send_in_background(
    background_tasks: BackgroundTasks,
    email: EmailSchema
    ) -&gt; JSONResponse:

    message = MessageSchema(
        subject=&quot;Fastapi mail module&quot;,
        recipients=email.dict().get(&quot;email&quot;),
        body=&quot;Simple background task&quot;,
        )

    fm = FastMail(conf)

    background_tasks.add_task(fm.send_message,message)

    return JSONResponse(status_code=200, content={&quot;message&quot;: &quot;email has been sent&quot;})
</code></pre>
<h3 id="sending-files">Sending files<a class="headerlink" href="#sending-files" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">
@app.post(&quot;/file&quot;)
async def send_file(
    background_tasks: BackgroundTasks,
    file: UploadFile = File(...),
    email:EmailStr = Form(...)
    ) -&gt; JSONResponse:

    message = MessageSchema(
            subject=&quot;Fastapi mail module&quot;,
            recipients=[email],
            body=&quot;Simple background task &quot;,
            attachments=[file]
            )

    fm = FastMail(conf)

    background_tasks.add_task(fm.send_message,message)

    return JSONResponse(status_code=200, content={&quot;message&quot;: &quot;email has been sent&quot;})
</code></pre>
<h3 id="using-jinja2-html-templates">Using Jinja2 HTML Templates<a class="headerlink" href="#using-jinja2-html-templates" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">
class EmailSchema(BaseModel):
    email: List[EmailStr]
    body: Dict[str, Any]

conf = ConnectionConfig(
    MAIL_USERNAME = &quot;YourUsername&quot;,
    MAIL_PASSWORD = &quot;strong_password&quot;,
    MAIL_FROM = &quot;your@email.com&quot;,
    MAIL_PORT = 587,
    MAIL_SERVER = &quot;your mail server&quot;,
    MAIL_TLS = True,
    MAIL_SSL = False,
    TEMPLATE_FOLDER='./email '
)


@app.post(&quot;/email&quot;)
async def send_with_template(email: EmailSchema) -&gt; JSONResponse:

    message = MessageSchema(
        subject=&quot;Fastapi-Mail module&quot;,
        recipients=email.dict().get(&quot;email&quot;),  # List of recipients, as many as you can pass 
        body=email.dict().get(&quot;body&quot;),
        subtype=&quot;html&quot;
        )

    fm = FastMail(conf)
    await fm.send_message(message, template_name=&quot;email_template.html&quot;) 
    return JSONResponse(status_code=200, content={&quot;message&quot;: &quot;email has been sent&quot;})


</code></pre>
<h2 id="guide-for-email-utils">Guide for email utils<a class="headerlink" href="#guide-for-email-utils" title="Permanent link">&para;</a></h2>
<p>The utility allows you to check temporary email addresses, you can block any email or domain. 
You can connect Redis to save and check email addresses. If you do not provide a Redis configuration, 
then the utility will save it in the list or set by default.</p>
<h3 id="check-dispasoble-email-address">Check dispasoble email address<a class="headerlink" href="#check-dispasoble-email-address" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">
async def default_checker():
    checker = DefaultChecker()  # you can pass source argument for your own email domains
    await checker.fetch_temp_email_domains() # require to fetch temporary email domains
    return checker


@app.get('/email/dispasoble')
async def simple_send(
    domain: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    if await checker.is_dispasoble(domain):
        return JSONResponse(status_code=400, content={'message': 'this is dispasoble domain'})

    return JSONResponse(status_code=200, content={'message': 'email has been sent'})

</code></pre>
<h3 id="add-dispasoble-email-address">Add dispasoble email address<a class="headerlink" href="#add-dispasoble-email-address" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.post('/email/dispasoble')
async def add_disp_domain(
    domains: list = Body(...,embed=True), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    res = await checker.add_temp_domain(domains)

    return JSONResponse(status_code=200, content={'result': res})
</code></pre>
<h3 id="add-domain-to-blocked-list">Add domain to blocked list<a class="headerlink" href="#add-domain-to-blocked-list" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.post('/email/blocked/domains')
async def block_domain(
    domain: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    await checker.blacklist_add_domain(domain)

    return JSONResponse(status_code=200, content={'message': f'{domain} added to blacklist'})
</code></pre>
<h3 id="check-domain-blocked-or-not">Check domain blocked or not<a class="headerlink" href="#check-domain-blocked-or-not" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.get('/email/blocked/domains')
async def get_blocked_domain(
    domain: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    res = await checker.is_blocked_domain(domain)

    return JSONResponse(status_code=200, content={&quot;result&quot;: res})
</code></pre>
<h3 id="add-email-address-to-blocked-list">Add email address to blocked list<a class="headerlink" href="#add-email-address-to-blocked-list" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.post('/email/blocked/address')
async def block_address(
    email: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    await checker.blacklist_add_email(email)

    return JSONResponse(status_code=200, content={&quot;result&quot;: True})
</code></pre>
<h3 id="check-email-blocked-or-not">Check email blocked or not<a class="headerlink" href="#check-email-blocked-or-not" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.get('/email/blocked/address')
async def get_block_address(
    email: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)) -&gt; JSONResponse:

    res = await checker.is_blocked_address(email)

    return JSONResponse(status_code=200, content={&quot;result&quot;: res})
</code></pre>
<h3 id="check-mx-record">Check MX record<a class="headerlink" href="#check-mx-record" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.get('/email/mx')
async def test_mx(
    email: EmailStr = Query(...),
    full_result: bool = Query(False) ,
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    domain = email.split(&quot;@&quot;)[-1]
    res = await checker.check_mx_record(domain,full_result)

    return JSONResponse(status_code=200, content=res)
</code></pre>
<h3 id="remove-email-address-from-blocked-list">Remove email address from blocked list<a class="headerlink" href="#remove-email-address-from-blocked-list" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.delete('/email/blocked/address')
async def del_blocked_address(
    email: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    res = await checker.blacklist_rm_email(email)

    return JSONResponse(status_code=200, content={&quot;result&quot;: res})
</code></pre>
<h3 id="remove-domain-from-blocked-list">Remove domain from blocked list<a class="headerlink" href="#remove-domain-from-blocked-list" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.delete('/email/blocked/domains')
async def del_blocked_domain(
    domain: str = Query(...), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    res = await checker.blacklist_rm_domain(domain)

    return JSONResponse(status_code=200, content={&quot;result&quot;: res})
</code></pre>
<h3 id="remove-domain-from-temporary-list">Remove domain from temporary list<a class="headerlink" href="#remove-domain-from-temporary-list" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@app.delete('/email/dispasoble')
async def del_disp_domain(
    domains: list = Body(...,embed=True), 
    checker: DefaultChecker = Depends(default_checker)
    ) -&gt; JSONResponse:

    res = await checker.blacklist_rm_temp(domains)

    return JSONResponse(status_code=200, content={'result': res})
</code></pre>
<h3 id="use-email-utils-with-redis">Use email utils with Redis<a class="headerlink" href="#use-email-utils-with-redis" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">
async def default_checker():
    checker = DefaultChecker(db_provider=&quot;redis&quot;)
    await checker.init_redis()
    return checker

</code></pre>
<h3 id="whoisxmlapi">WhoIsXmlApi<a class="headerlink" href="#whoisxmlapi" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from email_utils import WhoIsXmlApi

who_is = WhoIsXmlApi(token=&quot;Your access token&quot;, email=&quot;your@mailaddress.com&quot;)

print(who_is.smtp_check_())    #check smtp server
print(who_is.is_dispasoble()) # check email is disposable or not
print(who_is.check_mx_record()) # check domain mx records 
print(who_is.free_check) # check email domain is free or not

</code></pre>
<h2 id="unittests-using-fastapimail">Unittests using FastapiMail<a class="headerlink" href="#unittests-using-fastapimail" title="Permanent link">&para;</a></h2>
<p>Fastapi mails allows you to write unittest for your application without sending emails to
non existent email address by mocking the email to be sent. To mock sending out mails, set
the suppress configuraton to true. Suppress send defaults to False to prevent mocking within applications.</p>
<p>application.py</p>
<pre><code class="language-python">conf = ConnectionConfig(
    MAIL_USERNAME = &quot;YourUsername&quot;,
    MAIL_PASSWORD = &quot;strong_password&quot;,
    MAIL_FROM = &quot;your@email.com&quot;,
    MAIL_PORT = 587,
    MAIL_SERVER = &quot;your mail server&quot;,
    MAIL_TLS = True,
    MAIL_SSL = False,
    TEMPLATE_FOLDER='./email templates folder',

    # if no indicated SUPPRESS_SEND defaults to 0 (false) as below
    SUPPRESS_SEND=0
)

fm = FastMail(conf)

@app.post(&quot;/email&quot;)
async def simple_send(email: EmailSchema) -&gt; JSONResponse:

    message = MessageSchema(
        subject=&quot;Testing&quot;,
        recipients=email.dict().get(&quot;email&quot;),  # List of recipients, as many as you can pass 
        body=html,
        subtype=&quot;html&quot;
        )

    await fm.send_message(message)
    return JSONResponse(status_code=200, content={&quot;message&quot;: &quot;email has been sent&quot;})

</code></pre>
<p>test.py</p>
<pre><code class="language-python">from application.py import fm

# make this setting available as a fixture through conftest.py if you plan on using pytest
fm.config.SUPPRESS_SEND = 1

with fm.record_messages() as outbox:
    response = app.test_client.get(&quot;/email&quot;)
    assert len(outbox) == 1
    assert outbox[0].subject == &quot;Testing&quot;
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../getting-started/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                ðŸ•¹ Getting Started
              </div>
            </div>
          </a>
        
        
          <a href="../contribute/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Contirbution
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>